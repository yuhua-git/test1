<view class="container">
  <!-- BanneråŒºåŸŸ -->
  <view class="banner">
    <swiper class="banner-swiper" indicator-dots="true" autoplay="true" interval="3000" duration="500">
      <swiper-item wx:for="{{bannerList}}" wx:key="*this">
        <view class="banner-color-block" style="background-color: {{item}}"></view>
      </swiper-item>
    </swiper>
  </view>

  <!-- å®‰å…¨æ€åŠ¿æ„ŸçŸ¥ -->
  <view class="section">
    <view class="section-header">
      <text class="section-title">æ¼æ´æ‰«æ</text>
    </view>
    <view class="security-overview">
      <view class="security-score">
        <text class="score-value">{{securityScore}}</text>
        <text class="score-label">å®‰å…¨è¯„åˆ†</text>
      </view>
      <view class="security-stats">
        <view class="stat-item">
          <text class="stat-value warning">{{warningCount}}</text>
          <text class="stat-label">é£é™©é¢„è­¦</text>
        </view>
        <view class="stat-item">
          <text class="stat-value safe">{{safeCount}}</text>
          <text class="stat-label">å®‰å…¨èµ„äº§</text>
        </view>
      </view>
    </view>
  </view>

  <!-- å®‰å…¨æœåŠ¡å…¥å£ -->
  <view class="section">
    <view class="section-header">
      <text class="section-title">å®‰å…¨æœåŠ¡å…¥å£</text>
    </view>
    <view class="service-grid">
      <view class="service-item" wx:for="{{4}}" wx:key="*this">
        <view class="service-color-block" style="background-color: {{index === 0 ? '#4a90e2' : index === 1 ? '#50c878' : index === 2 ? '#ff6b6b' : '#ffa500'}}"></view>
        <text class="service-name">æœåŠ¡{{index + 1}}</text>
      </view>
    </view>
  </view>

  <!-- å®‰å…¨çŸ¥è¯† -->
  <view class="section">
    <view class="section-header">
      <text class="section-title">å®‰å…¨çŸ¥è¯†</text>
      <view class="more-link" bindtap="viewMoreNews">
        <text>æŸ¥çœ‹æ›´å¤š</text>
        <text class="arrow-text">â†’</text>
      </view>
    </view>
    <view class="news-list">
      <view class="news-item" wx:for="{{newsList}}" wx:key="id" bindtap="viewNewsDetail" data-id="{{item.id}}">
        <view class="news-color-block" style="background-color: {{item.bgColor}}"></view>
        <view class="news-info">
          <text class="news-title">{{item.title}}</text>
          <text class="news-time">{{item.time}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- é¡¹ç›®ç›‘æ§ -->
  <view class="section">
    <view class="section-header">
      <text class="section-title">é¡¹ç›®ç›‘æ§</text>
      <view class="more-link" bindtap="viewMoreProjects">
        <text>æŸ¥çœ‹æ›´å¤š</text>
        <text class="arrow-text">â†’</text>
      </view>
    </view>
    <view class="project-list">
      <view class="project-item" wx:for="{{projectList}}" wx:key="id" bindtap="viewProjectDetail" data-id="{{item.id}}">
        <view class="project-info">
          <text class="project-name">{{item.name}}</text>
          <text class="project-status {{item.status}}">{{item.statusText}}</text>
        </view>
        <view class="progress-bar">
          <view class="progress-inner" style="width: {{item.progress}}%"></view>
        </view>
        <text class="progress-text">è¿›åº¦ï¼š{{item.progress}}%</text>
      </view>
    </view>
  </view>

  <!-- AIæ™ºèƒ½é—®ç­” -->
  <view class="section chat-section">
    <view class="section-header">
      <text class="section-title">AIæ™ºèƒ½é—®ç­”</text>
    </view>
    <view class="chat-container">
      <scroll-view class="chat-history" scroll-y scroll-into-view="{{lastMessageId}}">
        <view class="chat-message {{item.type}}" wx:for="{{chatHistory}}" wx:key="index" id="msg-{{index}}">
          <image class="avatar" src="/images/{{item.type === 'user' ? 'user' : 'ai'}}-avatar.png" />
          <view class="message-content">
            <rich-text nodes="{{item.content}}"></rich-text>
            <view class="message-actions">
              <view class="action-btn copy-btn" catchtap="copyMessage" data-content="{{item.content}}" data-index="{{index}}">
                <text class="action-icon">ğŸ“‹</text>
                <text class="action-text">å¤åˆ¶</text>
              </view>
              <view class="action-btn quote-btn" catchtap="quoteMessage" data-content="{{item.content}}" data-type="{{item.type}}">
                <text class="action-icon">ğŸ’¬</text>
                <text class="action-text">å¼•ç”¨</text>
              </view>
            </view>
          </view>
        </view>
        <!-- åŠ è½½çŠ¶æ€æŒ‡ç¤ºå™¨ -->
        <view class="chat-message ai loading" wx:if="{{isLoading}}">
          <image class="avatar" src="/images/ai-avatar.png" />
          <view class="message-content">
            <view class="loading-dots">
              <view class="dot"></view>
              <view class="dot"></view>
              <view class="dot"></view>
            </view>
          </view>
        </view>
      </scroll-view>
      <view class="suggested-questions" wx:if="{{!chatHistory.length}}">
        <view class="question-title">å»ºè®®é—®é¢˜ï¼š</view>
        <view class="question-list">
          <view class="question-item" 
                wx:for="{{suggestedQuestions}}" 
                wx:key="*this"
                bindtap="selectQuestion"
                data-question="{{item}}">
            {{item}}
          </view>
        </view>
      </view>
      <view class="chat-input-container">
        <input class="chat-input" 
               type="text" 
               placeholder="è¯·è¾“å…¥æ‚¨çš„é—®é¢˜"
               value="{{chatInput}}"
               bindinput="onChatInput"
               focus="{{focusInput}}"
               bindblur="onInputBlur" />
        <button class="send-btn" bindtap="sendQuestion">å‘é€</button>
      </view>
    </view>
  </view>
</view>
